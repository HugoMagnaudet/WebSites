<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      *{
      box-sizing: border-box;
      }
      body {
      font: 16px Arial;
      }
      .autocomplete {
      position: relative;
      display: inline-block;
      }
      input {
      border: 1px solid transparent;
      background-color: #f1f1f1;
      padding: 10px;
      font-size: 16px;
      }
      input[type=text] {
      background-color: #f1f1f1;
      width: 100%;
      }
      input[type=submit] {
      background-color: DodgerBlue;
      color: #fff;
      cursor: pointer;
      }
      .autocomplete-items {
      position: absolute;
      border: 1px solid #d4d4d4;
      border-bottom: none;
      border-top: none;
      z-index: 99;
      top: 100%;
      left: 0;
      right: 0;
      }
      .autocomplete-items div {
      padding: 10px;
      cursor: pointer;
      background-color: #fff;
      border-bottom: 1px solid #d4d4d4;
      }
      .autocomplete-items div:hover {
      background-color: #e9e9e9;
      }
      .autocomplete-active {
      background-color: DodgerBlue !important;
      color: #ffffff;
      }
    </style>
    <title><%= v_site%></title>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <%if(v_login != undefined && v_admin){%>
    <div class="w3-bar w3-light-grey">
    <a class="w3-bar-item w3-button" href="http://localhost:8080/home/login">Accéder au site</a>
    <a class="w3-bar-item w3-button" href="http://localhost:8080/home/administration/commandes">Commandes</a>
    <div class="w3-dropdown-click">
      <button class="w3-button" onclick="myFunction()">
        Dropdown <i class="fa fa-caret-down"></i>
      </button>
      <div id="demo" class="w3-dropdown-content w3-bar-block w3-card">
        <a class="w3-bar-item w3-button" href="http://localhost:8080/home/modification">Editer mon Profil</a>
        <a class="w3-bar-item w3-button" href="http://localhost:8080/home/messagerie">Messagerie</a>
        <%if(v_admin){%>
        <a class="w3-bar-item w3-button" href="http://localhost:8080/home/administration/users">Clients</a>
        <%}%>
      </div>
    </div>
  </div>
    <%}%>
    <h1>Identifiez-vous sur <%= v_site%></h1>
    <% if(v_boll == false){%>
    <form id="myForm" id="iden" autocomplete="off" method="post" action="http://localhost:8080/home/inscription">
        <label class="form_col" for="lastName">Nom :</label>
        <input name="lastName" id="lastName" type="text" required="Champ Obligatoire"/>
        <br/>
	      <label class="form_col" for="lastName4">Prénom :</label>
        <input name="lastName4" id="lastName4" type="text" required="Champ Obligatoire"/>
	      <br/>
	      <label class="form_col" for="lastName">Login :</label>
        <input name="lastName2" id="lastName2" type="text" required="Champ Obligatoire"/>
        <br/>
        <label class="form_col" for="societe">Société :</label>

        <div class="autocomplete" style="width:300px;">
          <input id="societe" type="text" name="soc" placeholder="Société">
        </div>

        <br/>
        <label class="form_col" for="myMail">Mail :</label>
        <input name="myMail" id="myMail" type="mail" required="Champ Obligatoire"/>
        <br/>
        <label class="form_col" for="pwd1">Mot de passe :</label>
        <input name="pwd1" id="pwd1" type="password" required="Champ Obligatoire"/>
        <br/>
        <label class="form_col" for="pwd2">Mot de passe (confirmation) :</label>
        <input name="pwd2" id="pwd2" type="password" required="Champ Obligatoire"/>
		    <br/>
        <span class="form_col"></span>
        <input type="submit" value="M'inscrire" id="mailto_link"/> <input type="reset" value="Annuler" />
    </form>
    <%}%>
    <% if(v_boll == true){%>
    <form id="myForm" id="sign" method="post" action="http://localhost:8080/home/login">
	      <label class="form_col" for="lastName3">Login :</label>
        <input name="lastName3" id="lastName3" type="text" required="Champ Obligatoire"/>
        <br/>
        <label class="form_col" for="pwd1">Mot de passe :</label>
        <input name="pwd3" id="pwd3" type="password" required="Champ Obligatoire"/>
        <br/>
        <span class="form_col"></span>
        <input type="submit" value="M'identifier" /> <input type="reset" value="Annuler" />
    </form>
    <%}%>
    <hr>
    <address><a href="mailto:hugo.magnaudet@gmail.com">MAGNAUDET hugo</a></address>
  </body>

  <script>
    var element = document.getElementById('societe');
    var arr;
    $.get("http://localhost:8080/societe/dictionary/search?word="+element.value,function(data){
      arr = data;
    });
    function autocomplete(inp) {
      var currentFocus;
      element.addEventListener("input", function() {
        $.get("http://localhost:8080/societe/dictionary/search?word="+element.value,function(data){
          arr = data;
        });
        var a, b, val = this.value;
        closeAllLists();
        if (!val) {
          return false;
        }
        currentFocus = -1;
        a = document.createElement("DIV");
        a.setAttribute("id", this.id + "autocomplete-list");
        a.setAttribute("class", "autocomplete-items");
        this.parentNode.appendChild(a);
        for (var i = 0; i < arr.length; i++) {
          if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()){
            b = document.createElement("DIV");
            b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
            b.innerHTML += arr[i].substr(val.length);
            b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
            b.addEventListener("click", function(e) {
            inp.value = this.getElementsByTagName("input")[0].value;
              closeAllLists();
            });
            a.appendChild(b);
          }
        }
      });
      inp.addEventListener("keydown", function(e) {
        var x = document.getElementById(this.id + "autocomplete-list");
        if (x) x = x.getElementsByTagName("div");
        if (e.keyCode == 40) {
          currentFocus++;
          addActive(x);
        }
        else if (e.keyCode == 38){
          currentFocus--;
          addActive(x);
        }
        else if (e.keyCode == 13){
          e.preventDefault();
          if (currentFocus > -1){
            if (x) x[currentFocus].click();
          }
        }
      });
  function addActive(x){
    if (!x) return false;
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x){
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt){
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
        x[i].parentNode.removeChild(x[i]);
      }
    }
  }
  document.addEventListener("click", function (e) {
      closeAllLists(e.target);
  });
}
autocomplete(element);
  </script>
  <script>
function myFunction() {
  var x = document.getElementById("demo");
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
  } else {
    x.className = x.className.replace(" w3-show", "");
  }
}
</script>
  <script src="/script.js"></script>
</html>
